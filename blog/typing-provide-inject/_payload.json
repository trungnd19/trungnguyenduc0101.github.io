[{"data":1,"prerenderedAt":846},["ShallowReactive",2],{"content-query-jro3HgYdlY":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"draft":6,"publishedAt":10,"summary":9,"body":11,"_type":840,"_id":841,"_source":842,"_file":843,"_stem":844,"_extension":845},"/blog/typing-provide-inject","blog",false,"","Sử dụng Typescript với provide/ inject trong Vue","Cách typing provide/ inject trong Vue 3","2023-12-11T00:00:00.000Z",{"type":12,"children":13,"toc":838},"root",[14,22,36,45,50,62,289,551,811,815,832],{"type":15,"tag":16,"props":17,"children":19},"element","h1",{"id":18},"sử-dụng-typescript-với-provide-inject-trong-vue",[20],{"type":21,"value":8},"text",{"type":15,"tag":23,"props":24,"children":25},"p",{},[26,28,34],{"type":21,"value":27},"Trong bài blog ngắn của mình, ",{"type":15,"tag":29,"props":30,"children":31},"strong",{},[32],{"type":21,"value":33},"Anthony Fu",{"type":21,"value":35}," - core member của Vue, tác giả thư viện VueUse đã viết:",{"type":15,"tag":23,"props":37,"children":38},{},[39],{"type":15,"tag":40,"props":41,"children":42},"em",{},[43],{"type":21,"value":44},"\"Trước khi xem bài nói của Thorsten Lunborg tại sự kiện Vue Amsterdam, tôi đã không biết rằng ta có thể typing provide/ inject một cách dễ dàng như thế.\"",{"type":15,"tag":23,"props":46,"children":47},{},[48],{"type":21,"value":49},"Vậy cách typing provide/ inject của Lunborg (một core team member của Vue) như thế nào mà khiến Anthony Fu - tác giả của thư viện VueUse tuyệt vời ấn tượng đến thế?",{"type":15,"tag":23,"props":51,"children":52},{},[53,55,60],{"type":21,"value":54},"Với Vue, ta có thể dùng dạng string hoặc Symbol để dùng làm key khi provide/ inject một value. Ý tưởng cơ bản ở đây là Vue cung cấp cho ta ",{"type":15,"tag":29,"props":56,"children":57},{},[58],{"type":21,"value":59},"InjectionKey",{"type":21,"value":61}," - một type utility giúp ta có thể typing cho giá trị cần provide ứng với symbol key đó. Khi sử dụng provide/ inject với key dạng Symbol, Vue sẽ tự động infer type của value được provide/ inject cho chúng ta.",{"type":15,"tag":63,"props":64,"children":68},"pre",{"className":65,"code":66,"language":67,"meta":7,"style":7},"language-javascript shiki shiki-themes vitesse-light min-dark","// context.ts\nimport type { InjectionKey } from 'vue'\n\nexport interface UserInfo {\n  id: number\n  name: string\n}\n\nexport const InjectKeyUser: InjectionKey\u003CUserInfo> = Symbol()\n","javascript",[69],{"type":15,"tag":70,"props":71,"children":72},"code",{"__ignoreMap":7},[73,85,139,149,175,196,214,223,231],{"type":15,"tag":74,"props":75,"children":78},"span",{"class":76,"line":77},"line",1,[79],{"type":15,"tag":74,"props":80,"children":82},{"style":81},"--shiki-default:#A0ADA0;--shiki-dark:#6B737C",[83],{"type":21,"value":84},"// context.ts\n",{"type":15,"tag":74,"props":86,"children":88},{"class":76,"line":87},2,[89,95,100,106,112,117,122,128,134],{"type":15,"tag":74,"props":90,"children":92},{"style":91},"--shiki-default:#1E754F;--shiki-dark:#F97583",[93],{"type":21,"value":94},"import",{"type":15,"tag":74,"props":96,"children":97},{"style":91},[98],{"type":21,"value":99}," type",{"type":15,"tag":74,"props":101,"children":103},{"style":102},"--shiki-default:#999999;--shiki-dark:#B392F0",[104],{"type":21,"value":105}," {",{"type":15,"tag":74,"props":107,"children":109},{"style":108},"--shiki-default:#B07D48;--shiki-dark:#B392F0",[110],{"type":21,"value":111}," InjectionKey",{"type":15,"tag":74,"props":113,"children":114},{"style":102},[115],{"type":21,"value":116}," }",{"type":15,"tag":74,"props":118,"children":119},{"style":91},[120],{"type":21,"value":121}," from",{"type":15,"tag":74,"props":123,"children":125},{"style":124},"--shiki-default:#B5695977;--shiki-dark:#FFAB70",[126],{"type":21,"value":127}," '",{"type":15,"tag":74,"props":129,"children":131},{"style":130},"--shiki-default:#B56959;--shiki-dark:#FFAB70",[132],{"type":21,"value":133},"vue",{"type":15,"tag":74,"props":135,"children":136},{"style":124},[137],{"type":21,"value":138},"'\n",{"type":15,"tag":74,"props":140,"children":142},{"class":76,"line":141},3,[143],{"type":15,"tag":74,"props":144,"children":146},{"emptyLinePlaceholder":145},true,[147],{"type":21,"value":148},"\n",{"type":15,"tag":74,"props":150,"children":152},{"class":76,"line":151},4,[153,158,164,170],{"type":15,"tag":74,"props":154,"children":155},{"style":91},[156],{"type":21,"value":157},"export",{"type":15,"tag":74,"props":159,"children":161},{"style":160},"--shiki-default:#AB5959;--shiki-dark:#F97583",[162],{"type":21,"value":163}," interface",{"type":15,"tag":74,"props":165,"children":167},{"style":166},"--shiki-default:#2E8F82;--shiki-dark:#B392F0",[168],{"type":21,"value":169}," UserInfo",{"type":15,"tag":74,"props":171,"children":172},{"style":102},[173],{"type":21,"value":174}," {\n",{"type":15,"tag":74,"props":176,"children":178},{"class":76,"line":177},5,[179,184,190],{"type":15,"tag":74,"props":180,"children":181},{"style":108},[182],{"type":21,"value":183},"  id",{"type":15,"tag":74,"props":185,"children":187},{"style":186},"--shiki-default:#999999;--shiki-dark:#F97583",[188],{"type":21,"value":189},":",{"type":15,"tag":74,"props":191,"children":193},{"style":192},"--shiki-default:#2E8F82;--shiki-dark:#79B8FF",[194],{"type":21,"value":195}," number\n",{"type":15,"tag":74,"props":197,"children":199},{"class":76,"line":198},6,[200,205,209],{"type":15,"tag":74,"props":201,"children":202},{"style":108},[203],{"type":21,"value":204},"  name",{"type":15,"tag":74,"props":206,"children":207},{"style":186},[208],{"type":21,"value":189},{"type":15,"tag":74,"props":210,"children":211},{"style":192},[212],{"type":21,"value":213}," string\n",{"type":15,"tag":74,"props":215,"children":217},{"class":76,"line":216},7,[218],{"type":15,"tag":74,"props":219,"children":220},{"style":102},[221],{"type":21,"value":222},"}\n",{"type":15,"tag":74,"props":224,"children":226},{"class":76,"line":225},8,[227],{"type":15,"tag":74,"props":228,"children":229},{"emptyLinePlaceholder":145},[230],{"type":21,"value":148},{"type":15,"tag":74,"props":232,"children":234},{"class":76,"line":233},9,[235,239,244,250,254,258,263,268,273,278,284],{"type":15,"tag":74,"props":236,"children":237},{"style":91},[238],{"type":21,"value":157},{"type":15,"tag":74,"props":240,"children":241},{"style":160},[242],{"type":21,"value":243}," const",{"type":15,"tag":74,"props":245,"children":247},{"style":246},"--shiki-default:#B07D48;--shiki-dark:#79B8FF",[248],{"type":21,"value":249}," InjectKeyUser",{"type":15,"tag":74,"props":251,"children":252},{"style":186},[253],{"type":21,"value":189},{"type":15,"tag":74,"props":255,"children":256},{"style":166},[257],{"type":21,"value":111},{"type":15,"tag":74,"props":259,"children":260},{"style":102},[261],{"type":21,"value":262},"\u003C",{"type":15,"tag":74,"props":264,"children":265},{"style":166},[266],{"type":21,"value":267},"UserInfo",{"type":15,"tag":74,"props":269,"children":270},{"style":102},[271],{"type":21,"value":272},"> ",{"type":15,"tag":74,"props":274,"children":275},{"style":186},[276],{"type":21,"value":277},"=",{"type":15,"tag":74,"props":279,"children":281},{"style":280},"--shiki-default:#59873A;--shiki-dark:#B392F0",[282],{"type":21,"value":283}," Symbol",{"type":15,"tag":74,"props":285,"children":286},{"style":102},[287],{"type":21,"value":288},"()\n",{"type":15,"tag":63,"props":290,"children":292},{"className":65,"code":291,"language":67,"meta":7,"style":7},"// parent.vue\nimport { provide } from \"vue\";\nimport { InjectKeyUser } from \"./context\";\n\nexport default {\n  setup() {\n    provide(InjectKeyUser, {\n      id: \"117\", // type error: should be number\n      name: \"Anthony\",\n    });\n  },\n};\n",[293],{"type":15,"tag":70,"props":294,"children":295},{"__ignoreMap":7},[296,304,347,387,394,410,427,455,490,520,529,542],{"type":15,"tag":74,"props":297,"children":298},{"class":76,"line":77},[299],{"type":15,"tag":74,"props":300,"children":301},{"style":81},[302],{"type":21,"value":303},"// parent.vue\n",{"type":15,"tag":74,"props":305,"children":306},{"class":76,"line":87},[307,311,315,320,324,328,333,337,342],{"type":15,"tag":74,"props":308,"children":309},{"style":91},[310],{"type":21,"value":94},{"type":15,"tag":74,"props":312,"children":313},{"style":102},[314],{"type":21,"value":105},{"type":15,"tag":74,"props":316,"children":317},{"style":108},[318],{"type":21,"value":319}," provide",{"type":15,"tag":74,"props":321,"children":322},{"style":102},[323],{"type":21,"value":116},{"type":15,"tag":74,"props":325,"children":326},{"style":91},[327],{"type":21,"value":121},{"type":15,"tag":74,"props":329,"children":330},{"style":124},[331],{"type":21,"value":332}," \"",{"type":15,"tag":74,"props":334,"children":335},{"style":130},[336],{"type":21,"value":133},{"type":15,"tag":74,"props":338,"children":339},{"style":124},[340],{"type":21,"value":341},"\"",{"type":15,"tag":74,"props":343,"children":344},{"style":102},[345],{"type":21,"value":346},";\n",{"type":15,"tag":74,"props":348,"children":349},{"class":76,"line":141},[350,354,358,362,366,370,374,379,383],{"type":15,"tag":74,"props":351,"children":352},{"style":91},[353],{"type":21,"value":94},{"type":15,"tag":74,"props":355,"children":356},{"style":102},[357],{"type":21,"value":105},{"type":15,"tag":74,"props":359,"children":360},{"style":108},[361],{"type":21,"value":249},{"type":15,"tag":74,"props":363,"children":364},{"style":102},[365],{"type":21,"value":116},{"type":15,"tag":74,"props":367,"children":368},{"style":91},[369],{"type":21,"value":121},{"type":15,"tag":74,"props":371,"children":372},{"style":124},[373],{"type":21,"value":332},{"type":15,"tag":74,"props":375,"children":376},{"style":130},[377],{"type":21,"value":378},"./context",{"type":15,"tag":74,"props":380,"children":381},{"style":124},[382],{"type":21,"value":341},{"type":15,"tag":74,"props":384,"children":385},{"style":102},[386],{"type":21,"value":346},{"type":15,"tag":74,"props":388,"children":389},{"class":76,"line":151},[390],{"type":15,"tag":74,"props":391,"children":392},{"emptyLinePlaceholder":145},[393],{"type":21,"value":148},{"type":15,"tag":74,"props":395,"children":396},{"class":76,"line":177},[397,401,406],{"type":15,"tag":74,"props":398,"children":399},{"style":91},[400],{"type":21,"value":157},{"type":15,"tag":74,"props":402,"children":403},{"style":91},[404],{"type":21,"value":405}," default",{"type":15,"tag":74,"props":407,"children":408},{"style":102},[409],{"type":21,"value":174},{"type":15,"tag":74,"props":411,"children":412},{"class":76,"line":198},[413,418,423],{"type":15,"tag":74,"props":414,"children":415},{"style":280},[416],{"type":21,"value":417},"  setup",{"type":15,"tag":74,"props":419,"children":420},{"style":102},[421],{"type":21,"value":422},"()",{"type":15,"tag":74,"props":424,"children":425},{"style":102},[426],{"type":21,"value":174},{"type":15,"tag":74,"props":428,"children":429},{"class":76,"line":216},[430,435,440,445,451],{"type":15,"tag":74,"props":431,"children":432},{"style":280},[433],{"type":21,"value":434},"    provide",{"type":15,"tag":74,"props":436,"children":437},{"style":102},[438],{"type":21,"value":439},"(",{"type":15,"tag":74,"props":441,"children":442},{"style":108},[443],{"type":21,"value":444},"InjectKeyUser",{"type":15,"tag":74,"props":446,"children":448},{"style":447},"--shiki-default:#999999;--shiki-dark:#BBBBBB",[449],{"type":21,"value":450},",",{"type":15,"tag":74,"props":452,"children":453},{"style":102},[454],{"type":21,"value":174},{"type":15,"tag":74,"props":456,"children":457},{"class":76,"line":225},[458,464,468,472,477,481,485],{"type":15,"tag":74,"props":459,"children":461},{"style":460},"--shiki-default:#998418;--shiki-dark:#B392F0",[462],{"type":21,"value":463},"      id",{"type":15,"tag":74,"props":465,"children":466},{"style":186},[467],{"type":21,"value":189},{"type":15,"tag":74,"props":469,"children":470},{"style":124},[471],{"type":21,"value":332},{"type":15,"tag":74,"props":473,"children":474},{"style":130},[475],{"type":21,"value":476},"117",{"type":15,"tag":74,"props":478,"children":479},{"style":124},[480],{"type":21,"value":341},{"type":15,"tag":74,"props":482,"children":483},{"style":447},[484],{"type":21,"value":450},{"type":15,"tag":74,"props":486,"children":487},{"style":81},[488],{"type":21,"value":489}," // type error: should be number\n",{"type":15,"tag":74,"props":491,"children":492},{"class":76,"line":233},[493,498,502,506,511,515],{"type":15,"tag":74,"props":494,"children":495},{"style":460},[496],{"type":21,"value":497},"      name",{"type":15,"tag":74,"props":499,"children":500},{"style":186},[501],{"type":21,"value":189},{"type":15,"tag":74,"props":503,"children":504},{"style":124},[505],{"type":21,"value":332},{"type":15,"tag":74,"props":507,"children":508},{"style":130},[509],{"type":21,"value":510},"Anthony",{"type":15,"tag":74,"props":512,"children":513},{"style":124},[514],{"type":21,"value":341},{"type":15,"tag":74,"props":516,"children":517},{"style":447},[518],{"type":21,"value":519},",\n",{"type":15,"tag":74,"props":521,"children":523},{"class":76,"line":522},10,[524],{"type":15,"tag":74,"props":525,"children":526},{"style":102},[527],{"type":21,"value":528},"    });\n",{"type":15,"tag":74,"props":530,"children":532},{"class":76,"line":531},11,[533,538],{"type":15,"tag":74,"props":534,"children":535},{"style":102},[536],{"type":21,"value":537},"  }",{"type":15,"tag":74,"props":539,"children":540},{"style":447},[541],{"type":21,"value":519},{"type":15,"tag":74,"props":543,"children":545},{"class":76,"line":544},12,[546],{"type":15,"tag":74,"props":547,"children":548},{"style":102},[549],{"type":21,"value":550},"};\n",{"type":15,"tag":63,"props":552,"children":554},{"className":65,"code":553,"language":67,"meta":7,"style":7},"// child.vue\nimport { inject } from \"vue\";\nimport { InjectKeyUser } from \"./context\";\n\nexport default {\n  setup() {\n    const user = inject(InjectKeyUser); // UserInfo | undefined\n\n    if (user) console.log(user.name); // Anthony\n  },\n};\n",[555],{"type":15,"tag":70,"props":556,"children":557},{"__ignoreMap":7},[558,566,606,645,652,667,682,722,729,793,804],{"type":15,"tag":74,"props":559,"children":560},{"class":76,"line":77},[561],{"type":15,"tag":74,"props":562,"children":563},{"style":81},[564],{"type":21,"value":565},"// child.vue\n",{"type":15,"tag":74,"props":567,"children":568},{"class":76,"line":87},[569,573,577,582,586,590,594,598,602],{"type":15,"tag":74,"props":570,"children":571},{"style":91},[572],{"type":21,"value":94},{"type":15,"tag":74,"props":574,"children":575},{"style":102},[576],{"type":21,"value":105},{"type":15,"tag":74,"props":578,"children":579},{"style":108},[580],{"type":21,"value":581}," inject",{"type":15,"tag":74,"props":583,"children":584},{"style":102},[585],{"type":21,"value":116},{"type":15,"tag":74,"props":587,"children":588},{"style":91},[589],{"type":21,"value":121},{"type":15,"tag":74,"props":591,"children":592},{"style":124},[593],{"type":21,"value":332},{"type":15,"tag":74,"props":595,"children":596},{"style":130},[597],{"type":21,"value":133},{"type":15,"tag":74,"props":599,"children":600},{"style":124},[601],{"type":21,"value":341},{"type":15,"tag":74,"props":603,"children":604},{"style":102},[605],{"type":21,"value":346},{"type":15,"tag":74,"props":607,"children":608},{"class":76,"line":141},[609,613,617,621,625,629,633,637,641],{"type":15,"tag":74,"props":610,"children":611},{"style":91},[612],{"type":21,"value":94},{"type":15,"tag":74,"props":614,"children":615},{"style":102},[616],{"type":21,"value":105},{"type":15,"tag":74,"props":618,"children":619},{"style":108},[620],{"type":21,"value":249},{"type":15,"tag":74,"props":622,"children":623},{"style":102},[624],{"type":21,"value":116},{"type":15,"tag":74,"props":626,"children":627},{"style":91},[628],{"type":21,"value":121},{"type":15,"tag":74,"props":630,"children":631},{"style":124},[632],{"type":21,"value":332},{"type":15,"tag":74,"props":634,"children":635},{"style":130},[636],{"type":21,"value":378},{"type":15,"tag":74,"props":638,"children":639},{"style":124},[640],{"type":21,"value":341},{"type":15,"tag":74,"props":642,"children":643},{"style":102},[644],{"type":21,"value":346},{"type":15,"tag":74,"props":646,"children":647},{"class":76,"line":151},[648],{"type":15,"tag":74,"props":649,"children":650},{"emptyLinePlaceholder":145},[651],{"type":21,"value":148},{"type":15,"tag":74,"props":653,"children":654},{"class":76,"line":177},[655,659,663],{"type":15,"tag":74,"props":656,"children":657},{"style":91},[658],{"type":21,"value":157},{"type":15,"tag":74,"props":660,"children":661},{"style":91},[662],{"type":21,"value":405},{"type":15,"tag":74,"props":664,"children":665},{"style":102},[666],{"type":21,"value":174},{"type":15,"tag":74,"props":668,"children":669},{"class":76,"line":198},[670,674,678],{"type":15,"tag":74,"props":671,"children":672},{"style":280},[673],{"type":21,"value":417},{"type":15,"tag":74,"props":675,"children":676},{"style":102},[677],{"type":21,"value":422},{"type":15,"tag":74,"props":679,"children":680},{"style":102},[681],{"type":21,"value":174},{"type":15,"tag":74,"props":683,"children":684},{"class":76,"line":216},[685,690,695,700,704,708,712,717],{"type":15,"tag":74,"props":686,"children":687},{"style":160},[688],{"type":21,"value":689},"    const",{"type":15,"tag":74,"props":691,"children":692},{"style":246},[693],{"type":21,"value":694}," user",{"type":15,"tag":74,"props":696,"children":697},{"style":186},[698],{"type":21,"value":699}," =",{"type":15,"tag":74,"props":701,"children":702},{"style":280},[703],{"type":21,"value":581},{"type":15,"tag":74,"props":705,"children":706},{"style":102},[707],{"type":21,"value":439},{"type":15,"tag":74,"props":709,"children":710},{"style":108},[711],{"type":21,"value":444},{"type":15,"tag":74,"props":713,"children":714},{"style":102},[715],{"type":21,"value":716},");",{"type":15,"tag":74,"props":718,"children":719},{"style":81},[720],{"type":21,"value":721}," // UserInfo | undefined\n",{"type":15,"tag":74,"props":723,"children":724},{"class":76,"line":225},[725],{"type":15,"tag":74,"props":726,"children":727},{"emptyLinePlaceholder":145},[728],{"type":21,"value":148},{"type":15,"tag":74,"props":730,"children":731},{"class":76,"line":233},[732,737,742,747,752,757,762,767,771,775,779,784,788],{"type":15,"tag":74,"props":733,"children":734},{"style":91},[735],{"type":21,"value":736},"    if",{"type":15,"tag":74,"props":738,"children":739},{"style":102},[740],{"type":21,"value":741}," (",{"type":15,"tag":74,"props":743,"children":744},{"style":108},[745],{"type":21,"value":746},"user",{"type":15,"tag":74,"props":748,"children":749},{"style":102},[750],{"type":21,"value":751},")",{"type":15,"tag":74,"props":753,"children":754},{"style":246},[755],{"type":21,"value":756}," console",{"type":15,"tag":74,"props":758,"children":759},{"style":102},[760],{"type":21,"value":761},".",{"type":15,"tag":74,"props":763,"children":764},{"style":280},[765],{"type":21,"value":766},"log",{"type":15,"tag":74,"props":768,"children":769},{"style":102},[770],{"type":21,"value":439},{"type":15,"tag":74,"props":772,"children":773},{"style":246},[774],{"type":21,"value":746},{"type":15,"tag":74,"props":776,"children":777},{"style":102},[778],{"type":21,"value":761},{"type":15,"tag":74,"props":780,"children":781},{"style":108},[782],{"type":21,"value":783},"name",{"type":15,"tag":74,"props":785,"children":786},{"style":102},[787],{"type":21,"value":716},{"type":15,"tag":74,"props":789,"children":790},{"style":81},[791],{"type":21,"value":792}," // Anthony\n",{"type":15,"tag":74,"props":794,"children":795},{"class":76,"line":522},[796,800],{"type":15,"tag":74,"props":797,"children":798},{"style":102},[799],{"type":21,"value":537},{"type":15,"tag":74,"props":801,"children":802},{"style":447},[803],{"type":21,"value":519},{"type":15,"tag":74,"props":805,"children":806},{"class":76,"line":531},[807],{"type":15,"tag":74,"props":808,"children":809},{"style":102},[810],{"type":21,"value":550},{"type":15,"tag":812,"props":813,"children":814},"hr",{},[],{"type":15,"tag":23,"props":816,"children":817},{},[818],{"type":15,"tag":40,"props":819,"children":820},{},[821,823,831],{"type":21,"value":822},"Dịch từ bài viết của Anthony Fu (",{"type":15,"tag":824,"props":825,"children":829},"a",{"href":826,"rel":827},"https://antfu.me/posts/typed-provide-and-inject-in-vue",[828],"nofollow",[830],{"type":21,"value":826},{"type":21,"value":751},{"type":15,"tag":833,"props":834,"children":835},"style",{},[836],{"type":21,"value":837},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":7,"searchDepth":87,"depth":87,"links":839},[],"markdown","content:blog:typing-provide-inject.md","content","blog/typing-provide-inject.md","blog/typing-provide-inject","md",1726586636725]