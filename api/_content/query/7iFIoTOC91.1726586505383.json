{"_path":"/blog/click-outside-angular","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Tạo clickOutside Directive trong Angular","description":"Tạo directive xử lý trường hợp người dùng click ra ngoài dropdow/ dialog.","draft":false,"toc":true,"publishedAt":"2022-02-12T00:00:00.000Z","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"tạo-clickoutside-directive-trong-angular"},"children":[{"type":"text","value":"Tạo clickOutside Directive trong Angular"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Khi viết code làm một dropdown menu hay modal/ dialog, trường hợp click ra bên ngoài dropdown hay modal, người dùng thường mong muốn dropdown/ modal đó sẽ được đóng lại. Vậy nếu làm Front-end bằng Angular, chúng ta sẽ giải quyết bài toán đó như thế nào?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Câu trả lời: chúng ta sẽ tạo một custom directive để handle việc đóng dropdown/ modal khi người dùng click bên ngoài dropdown/ modal đó."}]},{"type":"element","tag":"h2","props":{"id":"i-clickoutside-directive-code-sample"},"children":[{"type":"text","value":"I. clickOutside Directive Code Sample"}]},{"type":"element","tag":"pre","props":{"code":"import {\n  Directive,\n  Input,\n  Output,\n  EventEmitter,\n  ElementRef,\n  HostListener,\n} from '@angular/core';\n\n@Directive({\n  selector: '[clickOutside]',\n})\nexport class ClickOutsideDirective {\n  @Output() clickOutside = new EventEmitter<void>();\n\n  constructor(private elementRef: ElementRef) {}\n\n  @HostListener('document:click', ['$event.target'])\n  public onClick(target: EventTarget) {\n    const clickedInside = this.elementRef.nativeElement.contains(target);\n    if (!clickedInside) {\n      this.clickOutside.emit();\n    }\n  }\n}\n","language":"javascript","meta":"","className":"language-javascript shiki shiki-themes vitesse-light min-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  Directive"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  Input"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  Output"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  EventEmitter"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  ElementRef"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  HostListener"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#F97583"},"children":[{"type":"text","value":" from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":" '"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B56959;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"@angular/core"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"@"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"Directive"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#998418;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  selector"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":" '"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B56959;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"[clickOutside]"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"})\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#F97583"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":" class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2E8F82;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ClickOutsideDirective"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  @"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"Output"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"()"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" clickOutside"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":" new"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" EventEmitter"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2E8F82;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":">();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":"  constructor"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":"private"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" elementRef"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2E8F82;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ElementRef"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" {}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  @"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"HostListener"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B56959;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"document:click"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B56959;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"$event.target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":"  public"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" onClick"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2E8F82;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" EventTarget"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" clickedInside"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A65E2B;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" this"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"elementRef"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"nativeElement"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"contains"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#F97583"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":"!"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"clickedInside"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A65E2B;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"      this"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"clickOutside"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"emit"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"ii-giải-thích"},"children":[{"type":"text","value":"II. Giải thích"}]},{"type":"element","tag":"h3","props":{"id":"_1-hostlistener"},"children":[{"type":"text","value":"1. @HostListener"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Đầu tiên, chúng ta sẽ sử dụng @HostListener decorator để lắng nghe sự kiện \"document:click\", là sự kiện sẽ xảy ra khi người dùng click vào bất kì element nào trong DOM."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"@HostListener"}]},{"type":"text","value":" decorator có 2 tham số:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"eventName?"}]},{"type":"text","value":": Tham số thứ nhất là tên sự kiện cần lắng nghe. Ở đây ta lắng nghe sự kiện "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"“document:click”"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"args?"}]},{"type":"text","value":": Tham số thứ hai là một array chứa các arguments mà ta sẽ truyền cho hàm xử lý sự kiện được gọi tới mỗi khi sự kiện cần lắng nghe (đã nêu trong tham số thứ nhất) xảy ra. Ở đây, ta truyền "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"“$event.target”"}]},{"type":"text","value":" cho hàm onClick(target: EventTarget). Parameter “target” của hàm onClick(target: EventTarget) ở đây chính là "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"“$event.target”"}]},{"type":"text","value":" được decorator truyền sang."}]}]},{"type":"element","tag":"pre","props":{"code":"  @HostListener('document:click', ['$event.target'])\n  public onClick(target: EventTarget) {\n    // ...\n  }\n","language":"javascript","meta":"","className":"language-javascript shiki shiki-themes vitesse-light min-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  @"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"HostListener"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B56959;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"document:click"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B56959;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"$event.target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  public"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" onClick"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#393A34;--shiki-dark:#B392F0"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"EventTarget"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A0ADA0;--shiki-dark:#6B737C"},"children":[{"type":"text","value":"    // ...\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  }\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"_2-elementref"},"children":[{"type":"text","value":"2. elementRef"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Dùng elementRef để trỏ tới element được gán directive"}]},{"type":"element","tag":"pre","props":{"code":"constructor(private elementRef: ElementRef) {}\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"constructor(private elementRef: ElementRef) {}\n"}]}]},{"type":"element","tag":"h3","props":{"id":"_3-nodecontains-method"},"children":[{"type":"text","value":"3. Node.contains() method"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Tiếp theo, ta sẽ dùng Node.contains() method, dùng để check xem một node có là child node của một node nào đó trong DOM Tree hay không. Method này trả về true/ false."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Nếu người dùng click bên trong element được gắn directive, Node.contains() method sẽ trả về true."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Ngược lại, nếu người dùng click bên ngoài element được gắn directive, Node.contains() method sẽ trả về false, khi đó ta sẽ emit @Output() clickOutside."}]}]},{"type":"element","tag":"pre","props":{"code":"const clickedInside = this.elementRef.nativeElement.contains(target);\nif (!clickedInside) {\n  this.clickOutside.emit();\n}\n","language":"javascript","meta":"","className":"language-javascript shiki shiki-themes vitesse-light min-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" clickedInside"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#A65E2B;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" this"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"elementRef"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"nativeElement"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"contains"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"target"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#F97583"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#AB5959;--shiki-dark:#F97583"},"children":[{"type":"text","value":"!"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"clickedInside"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#A65E2B;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"  this"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"clickOutside"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"emit"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"_4-sử-dụng-directive-vừa-tạo"},"children":[{"type":"text","value":"4. Sử dụng directive vừa tạo"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Import vào module có component cần sử dụng directive:"}]}]},{"type":"element","tag":"pre","props":{"code":"import { ClickOutsideDirective } from './click-outside.directive';\n\n@NgModule({\n  imports:      [ BrowserModule, FormsModule ],\n  declarations: [ AppComponent,  ClickOutsideDirective ],\n  bootstrap:    [ AppComponent ]\n})\n","language":"javascript","meta":"","className":"language-javascript shiki shiki-themes vitesse-light min-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" {"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ClickOutsideDirective"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" }"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#F97583"},"children":[{"type":"text","value":" from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":" '"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B56959;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"./click-outside.directive"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5695977;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"@"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#59873A;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"NgModule"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#998418;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  imports"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"      ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" BrowserModule"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" FormsModule"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ]"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#998418;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  declarations"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" AppComponent"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":","}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  ClickOutsideDirective"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ]"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#BBBBBB"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#998418;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"  bootstrap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#F97583"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"    ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" AppComponent"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" ]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"})\n"}]}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Trong template của component, có thể import như sau:\nCách 1: Nêu rõ tên directive và event binding hàm xử lý khi người dùng click outside dropdown/ dialog"}]}]},{"type":"element","tag":"pre","props":{"code":"<div clickOutside (clickOutside)=\"someHandler()\"></div>\n","language":"javascript","meta":"","className":"language-javascript shiki shiki-themes vitesse-light min-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B07D48;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" clickOutside"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B31D28;--shiki-dark:#B392F0;--shiki-default-font-style:italic;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":" (clickOutside)=\"someHandler()\"></div>\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Cách 2: ở đây, do tên directive và event binding trùng nhau, cộng với việc directive chỉ có duy nhất một event binding => không cần nêu tên directive"}]},{"type":"element","tag":"pre","props":{"code":"<div (clickOutside)=\"someHandler()\"></div>\n","language":"javascript","meta":"","className":"language-javascript shiki shiki-themes vitesse-light min-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#999999;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#1E754F;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B31D28;--shiki-dark:#B392F0;--shiki-default-font-style:italic;--shiki-dark-font-style:inherit"},"children":[{"type":"text","value":" (clickOutside)=\"someHandler()\"></div>\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"_5-stackblitz-link"},"children":[{"type":"text","value":"5. Stackblitz link:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Các bạn có thể tham khảo demo trên stackblitz:\n"},{"type":"element","tag":"a","props":{"href":"https://stackblitz.com/edit/angular-j7jqq2","rel":["nofollow"]},"children":[{"type":"text","value":"https://stackblitz.com/edit/angular-j7jqq2"}]}]},{"type":"element","tag":"h2","props":{"id":"reference"},"children":[{"type":"text","value":"Reference"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.willtaylor.blog/click-outside-directive/","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.willtaylor.blog/click-outside-directive/"}]},{"type":"text","value":" (link bài gốc)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://angular.io/api/core/HostListener","rel":["nofollow"]},"children":[{"type":"text","value":"https://angular.io/api/core/HostListener"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/Node/contains","rel":["nofollow"]},"children":[{"type":"text","value":"https://developer.mozilla.org/en-US/docs/Web/API/Node/contains"}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"i-clickoutside-directive-code-sample","depth":2,"text":"I. clickOutside Directive Code Sample"},{"id":"ii-giải-thích","depth":2,"text":"II. Giải thích","children":[{"id":"_1-hostlistener","depth":3,"text":"1. @HostListener"},{"id":"_2-elementref","depth":3,"text":"2. elementRef"},{"id":"_3-nodecontains-method","depth":3,"text":"3. Node.contains() method"},{"id":"_4-sử-dụng-directive-vừa-tạo","depth":3,"text":"4. Sử dụng directive vừa tạo"},{"id":"_5-stackblitz-link","depth":3,"text":"5. Stackblitz link:"}]},{"id":"reference","depth":2,"text":"Reference"}]}},"_type":"markdown","_id":"content:blog:click-outside-angular.md","_source":"content","_file":"blog/click-outside-angular.md","_stem":"blog/click-outside-angular","_extension":"md"}